<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tr√≤ Ch∆°i √în T·∫≠p Ti·∫øng Trung - B√†i 17</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Be Vietnam Pro', sans-serif;
        }
        .feedback-correct {
            animation: pop 0.5s ease;
        }
        .feedback-incorrect {
            animation: shake 0.5s ease;
        }
        @keyframes pop {
            0% { transform: scale(0.8); opacity: 0; }
            50% { transform: scale(1.1); opacity: 1; }
            100% { transform: scale(1); opacity: 1; }
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }
    </style>
</head>
<body class="bg-rose-50 text-gray-800 flex items-center justify-center min-h-screen p-4">

    <div id="game-container" class="w-full max-w-2xl mx-auto">

        <!-- M√†n h√¨nh b·∫Øt ƒë·∫ßu -->
        <div id="start-screen" class="text-center p-8 bg-white rounded-2xl shadow-lg">
            <h1 class="text-3xl md:text-4xl font-bold text-rose-600 mb-4">√în t·∫≠p B√†i 17 n√†o! üèÆ</h1>
            <p class="text-lg mb-6">B·∫°n ƒë√£ s·∫µn s√†ng ƒë·ªÉ "x·ª≠ l√Ω" c√¢u ch·ªØ "Êää" trong b√†i "Êää‚ÄúÁ¶è‚ÄùÂ≠óÂÄíÁùÄË¥¥Âú®Èó®‰∏ä" ch∆∞a? Th·ª≠ s·ª©c ngay th√¥i!</p>
            <img src="https://placehold.co/400x200/FFE4E6/E11D48?text=B%E1%BA%AFt+%C4%91%E1%BA%A7u!+%F0%9F%A5%B3" class="rounded-lg mx-auto mb-6" alt="H√¨nh ·∫£nh ch√†o m·ª´ng">
            <button id="start-btn" class="w-full bg-rose-500 hover:bg-rose-600 text-white font-bold py-3 px-6 rounded-lg text-xl transition-transform transform hover:scale-105">
                Ch∆°i ngay!
            </button>
        </div>

        <!-- M√†n h√¨nh ch√≠nh c·ªßa tr√≤ ch∆°i -->
        <div id="game-screen" class="hidden">
            <!-- Header th√¥ng tin -->
            <div class="flex justify-between items-center mb-4 bg-white p-4 rounded-xl shadow-md">
                <div>
                    <h2 id="section-title" class="text-xl font-bold text-rose-600"></h2>
                    <p id="question-counter" class="text-sm text-gray-500"></p>
                </div>
                <div class="text-right">
                    <div class="text-lg font-semibold">‚è∞ <span id="timer">00:00</span></div>
                    <div class="text-lg font-semibold">üèÜ <span id="score">0</span> ƒëi·ªÉm</div>
                </div>
            </div>

            <!-- Khu v·ª±c c√¢u h·ªèi -->
            <div class="bg-white p-6 rounded-2xl shadow-lg mb-4">
                <div id="question-container" class="mb-5 min-h-[60px]"></div>
                <div id="input-area" class="flex items-center gap-2">
                    <input type="text" id="answer-input" class="flex-grow p-3 border-2 border-rose-200 rounded-lg focus:ring-2 focus:ring-rose-400 focus:border-rose-400 outline-none transition" placeholder="Nh·∫≠p c√¢u tr·∫£ l·ªùi c·ªßa b·∫°n...">
                    <button id="check-btn" class="bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-5 rounded-lg transition">Ki·ªÉm tra</button>
                </div>
                 <div id="essay-area" class="hidden">
                    <textarea id="essay-input" rows="8" class="w-full p-3 border-2 border-rose-200 rounded-lg focus:ring-2 focus:ring-rose-400 focus:border-rose-400 outline-none transition" placeholder="Vi·∫øt ƒëo·∫°n vƒÉn m√¥ t·∫£ c√°c b∆∞·ªõc ·ªü ƒë√¢y..."></textarea>
                    <button id="submit-essay-btn" class="w-full mt-2 bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-5 rounded-lg transition">N·ªôp b√†i</button>
                </div>
            </div>
            
            <!-- Ph·∫£n h·ªìi -->
            <div id="feedback-message" class="text-center font-bold text-xl p-2 min-h-[40px]"></div>

            <!-- C√°c n√∫t ƒëi·ªÅu khi·ªÉn -->
            <div class="flex justify-center gap-4 mt-4">
                <button id="hint-btn" class="bg-sky-500 hover:bg-sky-600 text-white py-2 px-5 rounded-lg transition">üí° G·ª£i √Ω</button>
                <button id="skip-btn" class="bg-gray-400 hover:bg-gray-500 text-white py-2 px-5 rounded-lg transition">B·ªè qua</button>
            </div>
        </div>
        
        <!-- M√†n h√¨nh t·ªïng k·∫øt -->
        <div id="summary-screen" class="hidden text-center p-8 bg-white rounded-2xl shadow-lg">
            <h1 class="text-3xl md:text-4xl font-bold text-rose-600 mb-2">Ho√†n th√†nh xu·∫•t s·∫Øc! üéâ</h1>
            <p class="text-lg mb-6">C√πng xem l·∫°i k·∫øt qu·∫£ c·ªßa b·∫°n n√†o:</p>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-white mb-6">
                <div class="bg-green-500 p-4 rounded-lg">
                    <div class="text-4xl font-bold" id="correct-summary">0</div>
                    <div class="text-lg">ƒê√∫ng</div>
                </div>
                <div class="bg-red-500 p-4 rounded-lg">
                    <div class="text-4xl font-bold" id="incorrect-summary">0</div>
                    <div class="text-lg">Sai</div>
                </div>
                <div class="bg-blue-500 p-4 rounded-lg">
                    <div class="text-4xl font-bold" id="time-summary">00:00</div>
                    <div class="text-lg">T·ªïng th·ªùi gian</div>
                </div>
            </div>

            <div id="review-section" class="text-left mb-6">
                <h3 class="text-xl font-bold mb-3 text-rose-700">üîç C·∫ßn xem l·∫°i ·ªü:</h3>
                <ul id="mistake-list" class="list-disc list-inside bg-rose-50 p-4 rounded-lg"></ul>
            </div>
            
             <div id="essay-review-section" class="text-left mb-6 hidden">
                <h3 class="text-xl font-bold mb-3 text-rose-700">üìù C√°c b√†i vi·∫øt c·ªßa b·∫°n:</h3>
                <div id="saved-essay-container"></div>
            </div>

            <button id="restart-btn" class="w-full bg-rose-500 hover:bg-rose-600 text-white font-bold py-3 px-6 rounded-lg text-xl transition-transform transform hover:scale-105">
                Ch∆°i l·∫°i l·∫ßn n·ªØa
            </button>
        </div>
    </div>

    <script>
        // L·∫•y c√°c ph·∫ßn t·ª≠ DOM
        const startScreen = document.getElementById('start-screen');
        const gameScreen = document.getElementById('game-screen');
        const summaryScreen = document.getElementById('summary-screen');
        const startBtn = document.getElementById('start-btn');
        const restartBtn = document.getElementById('restart-btn');
        const sectionTitle = document.getElementById('section-title');
        const questionCounter = document.getElementById('question-counter');
        const timerEl = document.getElementById('timer');
        const scoreEl = document.getElementById('score');
        const questionContainer = document.getElementById('question-container');
        const answerInput = document.getElementById('answer-input');
        const checkBtn = document.getElementById('check-btn');
        const feedbackMessage = document.getElementById('feedback-message');
        const hintBtn = document.getElementById('hint-btn');
        const skipBtn = document.getElementById('skip-btn');
        const inputArea = document.getElementById('input-area');
        const essayArea = document.getElementById('essay-area');
        const essayInput = document.getElementById('essay-input');
        const submitEssayBtn = document.getElementById('submit-essay-btn');


        // D·ªØ li·ªáu tr√≤ ch∆°i ƒë∆∞·ª£c l·∫•y t·ª´ b√†i gi·∫£ng
        const gameData = [
            {
                title: "‚úçÔ∏è √în t·∫≠p Ch·ªØ H√°n",
                questions: [
                    { question: "Vi·∫øt ch·ªØ H√°n cho 'b√πzh√¨' (b·ªë tr√≠)", answer: "Â∏ÉÁΩÆ", hint: "Ch·ªØ ƒë·∫ßu ti√™n c√≥ b·ªô ÁΩí (v√µng) v√† ch·ªØ th·ª© hai c√≥ b·ªô Â∑æ (c√¢n)." },
                    { question: "Vi·∫øt ch·ªØ H√°n cho 'd«és«éo' (qu√©t d·ªçn)", answer: "ÊâìÊâ´", hint: "Ch·ªØ ƒë·∫ßu ti√™n c√≥ b·ªô Êâå(th·ªß), ch·ªØ th·ª© hai c≈©ng v·∫≠y." },
                    { question: "Vi·∫øt ch·ªØ H√°n cho 'gu√†' (treo)", answer: "ÊåÇ", hint: "B√™n tr√°i l√† b·ªô Êâå(th·ªß)." },
                    { question: "Vi·∫øt ch·ªØ H√°n cho 'tiƒì' (d√°n)", answer: "Ë¥¥", hint: "B√™n tr√°i l√† b·ªô Ë¥ù (b·ªëi)." },
                    { question: "Vi·∫øt ch·ªØ H√°n cho 'f√∫' (ph√∫c)", answer: "Á¶è", hint: "B√™n tr√°i l√† b·ªô Á§ª(th·ªã)." },
                    { question: "Vi·∫øt ch·ªØ H√°n cho 'du√¨li√°nr' (c√¢u ƒë·ªëi)", answer: "ÂØπËÅî", hint: "Ch·ªØ th·ª© hai c√≥ b·ªô ËÄ≥ (nhƒ©)." },
                ]
            },
            {
                title: "üìö √în t·∫≠p T·ª´ v·ª±ng",
                questions: [
                    { question: "'N·∫øm, th∆∞·ªüng th·ª©c' trong ti·∫øng Trung l√† g√¨?", answer: "ÂìÅÂ∞ù", hint: "√Çm H√°n Vi·ªát l√† 'ph·∫©m th∆∞·ªüng'." },
                    { question: "'T·ª± tay' l√†m g√¨ ƒë√≥ l√† g√¨?", answer: "‰∫≤Êâã", hint: "√Çm H√°n Vi·ªát l√† 'th√¢n th·ªß'." },
                    { question: "'H·ªôi tr∆∞·ªùng' trong ti·∫øng Trung l√† g√¨?", answer: "‰ºöÂú∫", hint: "√Çm H√°n Vi·ªát l√† 'h·ªôi tr∆∞·ªùng'." },
                    { question: "'ƒê·ªìng √Ω, nh·∫≠n l·ªùi' l√† g√¨?", answer: "Á≠îÂ∫î", hint: "√Çm H√°n Vi·ªát l√† 'ƒë√°p ·ª©ng'." },
                    { question: "'Ni·ªÅm vui b·∫•t ng·ªù' l√† g√¨?", answer: "ÊÉäÂñú", hint: "√Çm H√°n Vi·ªát l√† 'kinh h·ª∑'." },
                    { question: "'Hoa thu·ª∑ ti√™n' l√† g√¨?", answer: "Ê∞¥‰ªô", hint: "√Çm H√°n Vi·ªát l√† 'th·ªßy ti√™n'." },
                    { question: "'Th·ªãnh v∆∞·ª£ng' l√† g√¨?", answer: "ÂÖ¥Êó∫", hint: "√Çm H√°n Vi·ªát l√† 'h∆∞ng v∆∞·ª£ng'." },
                ]
            },
            {
                title: "ü§î √în t·∫≠p Ng·ªØ ph√°p (S·∫Øp x·∫øp c√¢u)",
                questions: [
                    { question: "S·∫Øp x·∫øp: Êàë / ‰π¶ / ÊîæÂú®‰π¶Êû∂‰∏ä / Êää", answer: "ÊàëÊää‰π¶ÊîæÂú®‰π¶Êû∂‰∏ä", hint: "Ch·ªß ng·ªØ + Êää + T√¢n ng·ªØ + ƒê·ªông t·ª´ + Th√†nh ph·∫ßn kh√°c." },
                    { question: "S·∫Øp x·∫øp: ËØ∑ / ‰Ω† / ËøôÂ∞Å‰ø° / ‰∫§ÁªôËÄÅÂ∏à / Êää", answer: "ËØ∑‰Ω†ÊääËøôÂ∞Å‰ø°‰∫§ÁªôËÄÅÂ∏à", hint: "C√¢u m·ªánh l·ªánh, ËØ∑ ƒë·ª©ng ƒë·∫ßu." },
                    { question: "S·∫Øp x·∫øp: Êàë‰ª¨ / ÊïôÂÆ§ / Â∏ÉÁΩÆÊàê / ‰ºöÂú∫ / Êää", answer: "Êàë‰ª¨ÊääÊïôÂÆ§Â∏ÉÁΩÆÊàê‰ºöÂú∫", hint: "C·∫•u tr√∫c Êää... + V + Êàê..." },
                    { question: "S·∫Øp x·∫øp: Â¶àÂ¶à / Ë°£Êúç / Ê¥óÂπ≤ÂáÄ‰∫Ü / Êää", answer: "Â¶àÂ¶àÊääË°£ÊúçÊ¥óÂπ≤ÂáÄ‰∫Ü", hint: "ƒê·ª´ng qu√™n ‰∫Ü ·ªü cu·ªëi c√¢u ƒë·ªÉ ch·ªâ s·ª± ho√†n th√†nh." },
                    { question: "S·∫Øp x·∫øp: ‰ªñ / Ê≤° / ‰Ωú‰∏ö / ÂÅöÂÆå / Êää", answer: "‰ªñÊ≤°Êää‰Ωú‰∏öÂÅöÂÆå", hint: "Ph√≥ t·ª´ ph·ªß ƒë·ªãnh 'Ê≤°' ƒë·ª©ng tr∆∞·ªõc 'Êää'." },
                ]
            },
            {
                title: "üìù V·∫≠n d·ª•ng th·ª±c t·∫ø",
                questions: [
                    { 
                        question: `
                            <div class='text-left text-base'>
                                <p class='font-bold text-center text-lg mb-4'>C√¢u 1: D·ªçn d·∫πp ph√≤ng</p>
                                <p class='mb-2'>T∆∞·ªüng t∆∞·ª£ng b·∫°n v·ª´a d·ªçn d·∫πp v√† trang tr√≠ l·∫°i ph√≤ng c·ªßa m√¨nh cho m·ªôt d·ªãp ƒë·∫∑c bi·ªát (nh∆∞ T·∫øt). H√£y vi·∫øt m·ªôt ƒëo·∫°n vƒÉn ng·∫Øn (50-80 ch·ªØ) k·ªÉ l·∫°i qu√° tr√¨nh ƒë√≥.</p>
                                <p class='font-bold'>Y√™u c·∫ßu:</p>
                                <ul class='list-disc list-inside bg-rose-50 p-3 rounded-md'>
                                    <li>S·ª≠ d·ª•ng √≠t nh·∫•t 3 c√¢u c√≥ c·∫•u tr√∫c 'Êää'.</li>
                                    <li>√Åp d·ª•ng c√°c c·∫•u tr√∫c ch·ªâ tr√¨nh t·ª± nh∆∞ <strong>È¶ñÂÖà/ÂÖà, ÂÖ∂Ê¨°/ÁÑ∂Âêé, ÊúÄÂêé</strong>.</li>
                                </ul>
                            </div>
                        `,
                        answer: "ESSAY",
                        hint: "B·∫°n c√≥ th·ªÉ b·∫Øt ƒë·∫ßu v·ªõi vi·ªác d·ªçn d·∫πp (È¶ñÂÖàÔºåÊàëÊää...), sau ƒë√≥ l√† s·∫Øp x·∫øp ƒë·ªì ƒë·∫°c (ÁÑ∂ÂêéÔºåÊàëÊää...), v√† cu·ªëi c√πng l√† trang tr√≠ (ÊúÄÂêéÔºåÊàëÊää...)."
                    },
                    { 
                        question: `
                            <div class='text-left text-base'>
                                <p class='font-bold text-center text-lg mb-4'>C√¢u 2: H∆∞·ªõng d·∫´n l√†m B√°nh M√¨</p>
                                <img src='https://tvpfood.com/wp-content/uploads/2024/11/huong-dan-cach-lam-banh-mi-cha-lua-tvpfood.com_8350d4b090294483861c4bfb6206aa5b_1024x1024.jpg' onerror="this.onerror=null;this.src='https://placehold.co/600x300/FECACA/9F1239?text=Image+Not+Found';" alt='C√°c b∆∞·ªõc l√†m b√°nh m√¨ ch·∫£ l·ª•a' class='rounded-lg mx-auto mb-4 w-full max-w-md'>
                                <p class='font-bold'>T·ª´ v·ª±ng tham kh·∫£o:</p>
                                <ul class='list-disc list-inside mb-4 bg-rose-50 p-3 rounded-md'>
                                    <li>B√°nh m√¨: <strong>Èù¢ÂåÖ (mi√†nbƒÅo)</strong></li>
                                    <li>Ch·∫£ l·ª•a: <strong>Ë∂äÂçóÁÅ´ËÖø (yu√®n√°n hu«ítu«ê)</strong></li>
                                    <li>X·∫ª ƒë√¥i b√°nh m√¨: <strong>ÊääÈù¢ÂåÖÂØπÂçäÂàáÂºÄ (b«é mi√†nbƒÅo du√¨b√†n qiƒìkƒÅi)</strong></li>
                                    <li>C·∫Øt l√°t ch·∫£: <strong>ÊääÁÅ´ËÖøÂàáÊàêÁâá (b«é hu«ítu«ê qiƒì ch√©ng pi√†n)</strong></li>
                                    <li>Th√™m/Nh√©t v√†o: <strong>Êää...ÊîæËøõ... (b«é...f√†ngj√¨n...)</strong></li>
                                    <li>D∆∞a leo: <strong>ÈªÑÁìú (hu√°ngguƒÅ)</strong></li>
                                    <li>Rau m√πi: <strong>È¶ôËèú (xiƒÅngc√†i)</strong></li>
                                    <li>X·ªãt t∆∞∆°ng ·ªõt: <strong>ÊääËæ£Ê§íÈÖ±Êå§‰∏äÂéª (b«é l√†jiƒÅoji√†ng j«ê sh√†ngq√π)</strong></li>
                                </ul>
                                <p class='font-bold'>Y√™u c·∫ßu: D·ª±a v√†o h√¨nh, h√£y vi·∫øt m·ªôt ƒëo·∫°n vƒÉn m√¥ t·∫£ c√°c b∆∞·ªõc l√†m m·ªôt ·ªï b√°nh m√¨.</p>
                                 <ul class='list-disc list-inside bg-rose-50 p-3 rounded-md'>
                                    <li>S·ª≠ d·ª•ng √≠t nh·∫•t 3 c√¢u c√≥ c·∫•u tr√∫c 'Êää'.</li>
                                    <li>√Åp d·ª•ng c√°c c·∫•u tr√∫c ch·ªâ tr√¨nh t·ª± nh∆∞ <strong>Á¨¨‰∏Ä, Á¨¨‰∫å, Á¨¨‰∏â...</strong>.</li>
                                </ul>
                            </div>
                        `,
                        answer: "ESSAY",
                        hint: "B·∫Øt ƒë·∫ßu b·∫±ng vi·ªác x·ª≠ l√Ω b√°nh m√¨ (Á¨¨‰∏ÄÊ≠•ÔºåÊääÈù¢ÂåÖ...), sau ƒë√≥ th√™m nh√¢n (Á¨¨‰∫åÊ≠•ÔºåÊääÁÅ´ËÖøÂíåÈªÑÁìú...), v√† cu·ªëi c√πng l√† th√™m n∆∞·ªõc s·ªët (ÊúÄÂêéÔºåÊääËæ£Ê§íÈÖ±...)."
                    }
                ]
            }
        ];

        // Bi·∫øn tr·∫°ng th√°i c·ªßa tr√≤ ch∆°i
        let currentSectionIndex = 0;
        let currentQuestionIndex = 0;
        let score = 0;
        let timer;
        let seconds = 0;
        let mistakes = [];
        let essayAnswers = [];

        // H√†m b·∫Øt ƒë·∫ßu tr√≤ ch∆°i
        function startGame() {
            currentSectionIndex = 0;
            currentQuestionIndex = 0;
            score = 0;
            seconds = 0;
            mistakes = [];
            essayAnswers = [];

            scoreEl.textContent = score;
            startScreen.classList.add('hidden');
            summaryScreen.classList.add('hidden');
            gameScreen.classList.remove('hidden');
            
            startTimer();
            loadQuestion();
        }

        function startTimer() {
            timerEl.textContent = '00:00';
            clearInterval(timer); 
            timer = setInterval(() => {
                seconds++;
                const mins = String(Math.floor(seconds / 60)).padStart(2, '0');
                const secs = String(seconds % 60).padStart(2, '0');
                timerEl.textContent = `${mins}:${secs}`;
            }, 1000);
        }

        function loadQuestion() {
            feedbackMessage.textContent = '';
            feedbackMessage.className = 'text-center font-bold text-xl p-2 min-h-[40px]';
            answerInput.value = '';
            
            if (currentSectionIndex >= gameData.length) {
                showSummary();
                return;
            }

            const section = gameData[currentSectionIndex];
            const question = section.questions[currentQuestionIndex];
            
            sectionTitle.textContent = section.title;
            questionCounter.textContent = `C√¢u ${currentQuestionIndex + 1} / ${section.questions.length}`;
            
            questionContainer.innerHTML = `<div class="text-xl md:text-2xl font-medium">${question.question}</div>`;

            if (question.answer === "ESSAY") {
                inputArea.classList.add('hidden');
                essayArea.classList.remove('hidden');
                essayInput.focus();
            } else {
                inputArea.classList.remove('hidden');
                essayArea.classList.add('hidden');
                answerInput.focus();
            }
        }

        function checkAnswer() {
            const userAnswer = answerInput.value.trim().replace(/[.,„ÄÇÔºå]/g, '');
            if (userAnswer === '') {
                feedbackMessage.textContent = 'B·∫°n ∆°i, ch∆∞a nh·∫≠p c√¢u tr·∫£ l·ªùi! ü§î';
                feedbackMessage.className += ' text-orange-500';
                return;
            }

            const correctAnswer = gameData[currentSectionIndex].questions[currentQuestionIndex].answer.replace(/[.,„ÄÇÔºå]/g, '');
            
            if (userAnswer === correctAnswer) {
                score += 10;
                scoreEl.textContent = score;
                feedbackMessage.textContent = 'Ch√≠nh x√°c! B·∫°n gi·ªèi qu√°! ‚úÖ';
                feedbackMessage.className += ' text-green-500 feedback-correct';
            } else {
                feedbackMessage.textContent = `Ti·∫øc qu√°, sai r·ªìi! ƒê√°p √°n ƒë√∫ng l√†: ${gameData[currentSectionIndex].questions[currentQuestionIndex].answer} ‚ùå`;
                feedbackMessage.className += ' text-red-500 feedback-incorrect';
                mistakes.push({
                    question: gameData[currentSectionIndex].questions[currentQuestionIndex].question,
                    yourAnswer: answerInput.value,
                    correctAnswer: gameData[currentSectionIndex].questions[currentQuestionIndex].answer
                });
            }
            setTimeout(nextQuestion, 1500);
        }

        function nextQuestion() {
            currentQuestionIndex++;
            if (currentQuestionIndex >= gameData[currentSectionIndex].questions.length) {
                currentSectionIndex++;
                currentQuestionIndex = 0;
            }
            loadQuestion();
        }
        
        function showHint() {
            const hint = gameData[currentSectionIndex].questions[currentQuestionIndex].hint;
            feedbackMessage.textContent = `üí° G·ª£i √Ω: ${hint}`;
            feedbackMessage.className = 'text-center font-bold text-xl p-2 min-h-[40px] text-sky-600';
        }

        function submitEssay() {
            essayAnswers.push(essayInput.value);
            essayInput.value = '';
            nextQuestion(); 
        }

        function showSummary() {
            clearInterval(timer);
            gameScreen.classList.add('hidden');
            summaryScreen.classList.remove('hidden');

            const correctCount = (score / 10);
            document.getElementById('correct-summary').textContent = correctCount;
            document.getElementById('incorrect-summary').textContent = mistakes.length;
            document.getElementById('time-summary').textContent = timerEl.textContent;

            const mistakeList = document.getElementById('mistake-list');
            mistakeList.innerHTML = '';
            if (mistakes.length === 0) {
                mistakeList.innerHTML = '<li>Ch√∫c m·ª´ng! B·∫°n kh√¥ng sai c√¢u n√†o.</li>';
            } else {
                mistakes.forEach(mistake => {
                    const li = document.createElement('li');
                    const questionDiv = document.createElement('div');
                    questionDiv.innerHTML = mistake.question;
                    li.innerHTML = `<b>C√¢u h·ªèi:</b> "${questionDiv.innerText.split('\n')[0]}" <br> <span class="text-red-600">B·∫°n tr·∫£ l·ªùi: ${mistake.yourAnswer}</span> | <span class="text-green-600">ƒê√°p √°n ƒë√∫ng: ${mistake.correctAnswer}</span>`;
                    mistakeList.appendChild(li);
                });
            }
            
            const essayReviewSection = document.getElementById('essay-review-section');
            const savedEssayContainer = document.getElementById('saved-essay-container');
            savedEssayContainer.innerHTML = '';
            if (essayAnswers.length > 0) {
                essayReviewSection.classList.remove('hidden');
                 essayAnswers.forEach((answer, index) => {
                    if (answer.trim() !== '') {
                        const essayDiv = document.createElement('div');
                        essayDiv.className = 'bg-gray-100 p-4 rounded-lg whitespace-pre-wrap mb-2';
                        essayDiv.innerHTML = `<p class="font-semibold mb-1">B√†i vi·∫øt ${index + 1}:</p><p>${answer}</p>`;
                        savedEssayContainer.appendChild(essayDiv);
                    }
                });
            } else {
                essayReviewSection.classList.add('hidden');
            }
        }

        startBtn.addEventListener('click', startGame);
        restartBtn.addEventListener('click', startGame);
        checkBtn.addEventListener('click', checkAnswer);
        answerInput.addEventListener('keyup', (e) => {
            if (e.key === 'Enter') {
                checkAnswer();
            }
        });
        skipBtn.addEventListener('click', nextQuestion);
        hintBtn.addEventListener('click', showHint);
        submitEssayBtn.addEventListener('click', submitEssay);
    </script>
</body>
</html>
